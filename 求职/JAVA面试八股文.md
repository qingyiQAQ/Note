# JAVA面试八股文

## Redis篇

### 缓存穿透

1、定义：查询一个**不存在**的数据，mysql查询不到数据也不会写入缓存，导致一直查询数据库

2、解决方案：

（1）缓存空数据null
优点：简单
缺点：消耗内存，可能发生不一致问题（空数据突然有值了）

（2）布隆过滤器，有请求先在布隆过滤器中检查值是否合法

使用bitmap位图实现
一个id通过多个hash函数取值后写入位图，只有多个hash对应处有值才代表这个id存在

优点：内存占用少，没有多余key
缺点：实现复杂，存在误判

### 缓存击穿

1、定义：某个key过期的时候，刚好来大量请求，瞬间压垮DB

2、解决方案：

（1）**互斥锁**：

优点：结果强一致性
缺点：性能差

（2）**逻辑过期**：不设置过期时间，直接返回过期数据

优点：高可用性、性能好
缺点：不能保证数据绝对一致

### 缓存雪崩

1、定义：同一时段大量key失效或redis宕机，导致DB压力巨大

2、解决方案：

（1）给不同的key设置**随机**值的TTL（过期时间）

（2）利用Redis**集群**提高服务器可用性（哨兵模式、集群模式）

（3）给缓存添加降级**限流**策略（ngxin、spring cloud gateway）
使用与穿透、击穿、雪崩

（4）给业务添加多级缓存（Guava Caffeine）

### 双写一致性

1、定义：数据库数据更新的时候缓存也要更新